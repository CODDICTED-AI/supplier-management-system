# 环境变量配置模板

## 📋 环境变量说明

本系统需要配置以下环境变量才能正常运行。请根据您的实际部署情况填写相应的值。

## 🗄️ Supabase 数据库配置

### 获取 Supabase 连接信息

1. 登录 [Supabase](https://supabase.com)
2. 进入您的项目仪表板
3. 点击左侧菜单 "Settings" → "Database"
4. 复制以下信息：

```bash
# 数据库主机地址
DB_HOST=db.xxxxxxxxxxxxx.supabase.co

# 数据库用户名
DB_USER=postgres

# 数据库密码（您在创建项目时设置的密码）
DB_PASSWORD=your_database_password

# 数据库名称
DB_NAME=postgres

# 数据库端口
DB_PORT=5432

# 是否启用 SSL 连接
DB_SSL=true
```

## ⚙️ Render 后端环境变量

在 Render 的 Web Service 配置中，添加以下环境变量：

```bash
# 数据库配置
DB_HOST=db.xxxxxxxxxxxxx.supabase.co
DB_USER=postgres
DB_PASSWORD=your_database_password
DB_NAME=postgres
DB_PORT=5432
DB_SSL=true

# 服务器配置
PORT=3001
NODE_ENV=production

# 文件上传配置
UPLOAD_PATH=./uploads
```

## 🎨 Vercel 前端环境变量

在 Vercel 项目配置中，添加以下环境变量：

```bash
# API 基础 URL（替换为您的 Render 后端 URL）
REACT_APP_API_URL=https://your-backend-name.onrender.com/api
```

## 🔧 本地开发环境变量

### 后端环境变量 (.env 文件)

在 `backend` 目录下创建 `.env` 文件：

```bash
# 数据库配置
DB_HOST=localhost
DB_USER=postgres
DB_PASSWORD=your_local_password
DB_NAME=supplier_management
DB_PORT=5432
DB_SSL=false

# 服务器配置
PORT=3001
NODE_ENV=development

# 文件上传配置
UPLOAD_PATH=./uploads
```

### 前端环境变量 (.env 文件)

在 `frontend` 目录下创建 `.env` 文件：

```bash
# API 基础 URL（本地开发）
REACT_APP_API_URL=http://localhost:3001/api
```

## 🚨 重要注意事项

### 1. 安全性
- ⚠️ **永远不要**将包含真实密码的 `.env` 文件提交到 Git 仓库
- ✅ 确保 `.env` 文件已添加到 `.gitignore` 中
- ✅ 在生产环境中使用强密码

### 2. 环境变量命名
- ✅ 后端环境变量：`DB_HOST`, `DB_USER`, `DB_PASSWORD` 等
- ✅ 前端环境变量：必须以 `REACT_APP_` 开头，如 `REACT_APP_API_URL`

### 3. 数据库连接
- ✅ 确保 Supabase 项目已创建
- ✅ 确保数据库表已正确创建
- ✅ 验证网络连接和防火墙设置

### 4. URL 配置
- ✅ 后端 URL 格式：`https://your-backend-name.onrender.com`
- ✅ 前端 API URL 格式：`https://your-backend-name.onrender.com/api`
- ✅ 确保 URL 末尾没有斜杠

## 🔍 验证配置

### 1. 验证后端配置
访问后端健康检查端点：
```
https://your-backend-name.onrender.com/api/health
```

应该返回：
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### 2. 验证前端配置
- 前端页面能正常加载
- 能正常调用后端 API
- 没有控制台错误

### 3. 验证数据库连接
- 后端日志显示 "数据库连接成功"
- 能正常进行数据库操作

## 🛠️ 故障排除

### 常见错误及解决方案

#### 1. 数据库连接失败
```
错误: ECONNREFUSED
解决: 检查 DB_HOST 和 DB_PORT 是否正确
```

#### 2. 认证失败
```
错误: authentication failed
解决: 检查 DB_USER 和 DB_PASSWORD 是否正确
```

#### 3. 前端无法连接后端
```
错误: Failed to fetch
解决: 检查 REACT_APP_API_URL 是否正确设置
```

#### 4. 环境变量未生效
```
错误: undefined
解决: 重启服务，确保环境变量已正确加载
```

## 📞 获取帮助

如果在配置过程中遇到问题：

1. **检查日志**：查看服务日志获取详细错误信息
2. **验证配置**：确保所有环境变量都已正确设置
3. **测试连接**：使用健康检查端点验证服务状态
4. **参考文档**：查看 `完整部署指南.md` 获取详细步骤

---

**提示**: 请将上述模板中的占位符（如 `xxxxxxxxxxxxx`, `your_database_password` 等）替换为您的实际值。 